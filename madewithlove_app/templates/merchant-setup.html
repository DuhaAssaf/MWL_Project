{% extends 'base.html' %}
{% load static %}
{% block title %}Setup Your Profile{% endblock %}

{% block content %}
<div class="card shadow p-4 border-0 rounded-4">
<div class="container mt-5">
    <h2 class="text-center text-warning mb-4">
        Welcome, {{ request.session.username|default:"User" }} â€” Complete Your Profile Please
    </h2>

    {% if error %}
        <div class="alert alert-danger text-center">{{ error }}</div>
    {% endif %}

    <form method="POST" enctype="multipart/form-data" id="profileForm" novalidate>
        {% csrf_token %}

        <div class="mb-3">
            <label>Profile Picture</label>
            <input type="file" name="profile_picture" class="form-control" id="profilePictureInput">
            <div class="mt-3 text-center">
                <img id="profilePreview" src="#" alt="Image Preview"
                    class="img-fluid rounded" style="max-width: 200px; display: none;">
            </div>
        </div>

        <div class="mb-3">
            <label>Store Name</label>
            <input type="text" name="store_name" class="form-control" required minlength="6"
                  value="{{ profile.store_name }}">
        </div>

        <div class="mb-3">
          <label>Store Picture</label>
          <input type="file" name="store_logo" class="form-control" id="profilePictureInput">
          <div class="mt-3 text-center">
              <img id="profilePreview" src="#" alt="Image Preview"
                  class="img-fluid rounded" style="max-width: 200px; display: none;">
          </div>
      </div>


        <div class="mb-3">
            <label>Category</label>
            <select name="category" class="form-select" required>
                <option value="">Select a category</option>
                {% for category in categories %}
                    <option value="{{ category.slug }}"
                        {% if profile.category and profile.category.slug == category.slug %}selected{% endif %}>
                        {{ category }}
                    </option>
                {% endfor %}
            </select>
        </div>

        <div class="mb-3">
            <label>Description</label>
            <textarea name="description" class="form-control" rows="3" required minlength="15">{{ profile.description }}</textarea>
        </div>

        <div class="mb-3">
            <label>Payout Method (Optional)</label>
            <input type="text" name="payout_method" class="form-control" value="{{ profile.payout_method }}">
        </div>

        <div class="mb-3">
            <label>Payout Email</label>
            <input type="email" name="payout_email" class="form-control" required value="{{ profile.payout_email }}">
        </div>

        <div class="mb-3">
            <label>Country</label>
            <input type="text" name="country" class="form-control" required value="{{ profile.country }}">
        </div>

        <button type="submit" class="btn btn-primary w-100">Save and Continue</button>
    </form>
</div>
</div>
<script src="{% static 'js/script.js' %}"></script>
{% endblock %}
